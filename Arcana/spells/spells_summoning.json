[
  {
    "id": "arcana_summoning",
    "type": "magic_type",
    "energy_source": "NONE",
    "cannot_cast_flags": [ "NO_ARCANA_MAGIC", "NO_ARCANA_SUMMONING", "NO_SPELLCASTING" ],
    "failure_cost_percent": 1,
    "max_book_level": 5,
    "cannot_cast_message": "You cannot reach out to the Beyond!",
    "failure_chance_formula_id": "arcana_summoning_failure_chance"
  },
  {
    "//": "Summoning spells characteristics only go up 10 levels, but the spells scale to level 15 for extra bonuses on the control roll",
    "//2": "Control difficulty is spell Difficulty / 10, plus 6.",
    "id": "arcana_summoning_successful_control",
    "type": "SPELL",
    "name": { "str": "Control Summon", "//~": "NO_I18N" },
    "description": { "str": "This spell is used if the summoning control is successful.", "//~": "NO_I18N" },
    "message": "",
    "valid_targets": [ "ground", "ally", "hostile" ],
    "flags": [ "SILENT" ],
    "effect": "charm_monster",
    "shape": "blast",
    "energy_source": "STAMINA",
    "max_level": 15,
    "difficulty": 60,
    "skill": "magic",
    "min_aoe": 3,
    "max_aoe": 3,
    "min_damage": 10000,
    "max_damage": 10000,
    "min_range": 40,
    "max_range": 40,
    "min_duration": 7200000,
    "max_duration": 14400000,
    "duration_increment": 720000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning",
    "targeted_monster_species": [ "SUMMONED_CREATURE" ]
  },
  {
    "id": "arcana_summoning_increase_success_chance",
    "type": "SPELL",
    "name": "The Rites of Evocation",
    "description": "Summoning is very risky but it's possible to make it less so with the proper rites.  This ritual, when performed before a summoning attempt, greatly increases the odds of that which you summon submitting to your control.",
    "message": "\"By the depths of the ocean, by the light of the stars, by the circles of the moon, I bind you, I bind you, I bind you…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "SILENT", "NO_FAIL" ],
    "effect": "attack",
    "effect_str": "effect_arcana_summoning_bonus_chance",
    "shape": "blast",
    "energy_source": "STAMINA",
    "max_level": 1,
    "difficulty": 10,
    "min_duration": 6000,
    "max_duration": 6000,
    "base_casting_time": 6000,
    "base_energy_cost": 2000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "id": "arcana_summoning_skeletal_dog",
    "type": "SPELL",
    "name": { "str": "Call Forth the Hound of Bone" },
    "description": "Using this spell will summon an animalistic revenant, which will be loyal but not permanent.  It is <color_yellow>somewhat easy</color> to control.  You <color_yellow>must target diggable ground</color> for the summoning to succeed.",
    "message": "\"Loyal unto death, and even beyond…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_SKELETAL_DOG",
    "energy_source": "STAMINA",
    "difficulty": 30,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 320,
    "final_casting_time": 160,
    "casting_time_increment": -16,
    "base_energy_cost": 2000,
    "final_energy_cost": 1000,
    "energy_increment": -100,
    "min_duration": 360000,
    "max_duration": 720000,
    "duration_increment": 36000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_SKELETAL_DOG",
    "//": "98% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Hound of Bone",
        "range": { "math": [ "(u_spell_level('arcana_summoning_skeletal_dog') * 0.5) + 3" ] }
      },
      {
        "if": {
          "and": [
            { "math": [ "has_var(_summoning_loc)" ] },
            { "map_terrain_with_flag": "DIGGABLE", "loc": { "context_val": "summoning_loc" } }
          ]
        },
        "then": {
          "u_spawn_monster": "mon_dog_skeleton_summoned",
          "summoner_is_alpha": true,
          "real_count": 1,
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_skeletal_dog') * 360.00) + 3600.00" ] },
          "spawn_message": "The hound of bone digs its way out of the ground!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_crawling_things') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 9 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resists your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_shadow",
    "type": "SPELL",
    "name": { "str": "Call Forth the Dark One" },
    "description": "Using this spell will summon a living shadow that prowls the night.  You must be indoors or at night to summon the shadow.  It is <color_yellow>somewhat easy</color> to control.",
    "message": "\"Neherit, otira atvess…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "caster_condition": { "or": [ { "not": "is_day" }, { "not": "u_is_outside" } ] },
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_SHADOW",
    "energy_source": "STAMINA",
    "difficulty": 30,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 320,
    "final_casting_time": 160,
    "casting_time_increment": -16,
    "base_energy_cost": 3000,
    "final_energy_cost": 1500,
    "energy_increment": -150,
    "min_duration": 600000,
    "max_duration": 1200000,
    "duration_increment": 60000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_SHADOW",
    "//": "98% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Dark One",
        "range": { "math": [ "(u_spell_level('arcana_summoning_shadow') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_shadow_summoned",
          "summoner_is_alpha": true,
          "real_count": 1,
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_shadow') * 600.00) + 6000.00" ] },
          "spawn_message": "An animate shadow detaches from a nearby patch of darkness!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_crawling_things') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 9 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resists your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_kreck_group",
    "type": "SPELL",
    "name": { "str": "Calling the Lean and Hungry Ones" },
    "description": "Using this spell will summon a pack of otherworldly hounds.  They are <color_yellow>somewhat difficult</color> to control.",
    "message": "\"The hunt is up!  Come forth, and let your howls strike fear into mortals' hearts…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_KRECK_GROUP",
    "difficulty": 50,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 480,
    "final_casting_time": 240,
    "casting_time_increment": -24,
    "base_energy_cost": 3350,
    "final_energy_cost": 1650,
    "energy_increment": -165,
    "min_duration": 680000,
    "max_duration": 1360000,
    "duration_increment": 68000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_KRECK_GROUP",
    "//": "95% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Lean and Hungry Ones",
        "range": { "math": [ "(u_spell_level('arcana_summoning_kreck_group') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_kreck_summoned",
          "summoner_is_alpha": true,
          "real_count": { "math": [ "(u_spell_level('arcana_summoning_kreck_group') * 0.4) + 2" ] },
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_kreck_group') * 680.00) + 6800.00" ] },
          "spawn_message": "With a chilling baying sound, canine shapes appear!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_kreck_group') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 11 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The things you called up resist your attempt to control them!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_dark_wyrm",
    "type": "SPELL",
    "name": { "str": "Calling the Worms of the Earth" },
    "description": "Using this spell will summon a dark wyrm.  It is <color_yellow>somewhat difficult</color> to control.  You <color_yellow>must target diggable ground</color> for the summoning to succeed.",
    "message": "\"Crawlers from below, writhe forth and devour those who walk upon the earth…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_DARK_WYRM",
    "difficulty": 50,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 480,
    "final_casting_time": 240,
    "casting_time_increment": -24,
    "base_energy_cost": 3350,
    "final_energy_cost": 1650,
    "energy_increment": -165,
    "min_duration": 680000,
    "max_duration": 1360000,
    "duration_increment": 68000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_DARK_WYRM",
    "//": "95% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Dark Wyrm",
        "range": { "math": [ "(u_spell_level('arcana_summoning_dark_wyrm') * 0.5) + 3" ] }
      },
      {
        "if": {
          "and": [
            { "math": [ "has_var(_summoning_loc)" ] },
            { "map_terrain_with_flag": "DIGGABLE", "loc": { "context_val": "summoning_loc" } }
          ]
        },
        "then": {
          "u_spawn_monster": "mon_dark_wyrm_summoned",
          "summoner_is_alpha": true,
          "real_count": { "math": [ "(u_spell_level('arcana_summoning_dark_wyrm') * 0.2) + 1" ] },
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_dark_wyrm') * 680.00) + 6800.00" ] },
          "spawn_message": "The ground churns ominously!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_dark_wyrm') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 11 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resists your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_crawling_things",
    "type": "SPELL",
    "name": { "str": "Call Forth the Crawling Ones" },
    "description": "Using this spell will summon a twisted mockery of the human form to grasp at your foes.  It is <color_yellow>somewhat difficult</color> to control.",
    "message": "\"I am that which is grim yet necessary, for there is no life without death…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_CRAWLING_THINGS",
    "energy_source": "STAMINA",
    "max_level": 10,
    "difficulty": 60,
    "skill": "magic",
    "base_casting_time": 560,
    "final_casting_time": 280,
    "casting_time_increment": -28,
    "base_energy_cost": 3500,
    "final_energy_cost": 1750,
    "energy_increment": -175,
    "min_duration": 720000,
    "max_duration": 1440000,
    "duration_increment": 72000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_CRAWLING_THINGS",
    "//": "94% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Crawling Thing",
        "range": { "math": [ "(u_spell_level('arcana_summoning_crawling_things') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_crawler_summoned",
          "summoner_is_alpha": true,
          "real_count": { "math": [ "(u_spell_level('arcana_summoning_crawling_things') * 0.2) + 1" ] },
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_crawling_things') * 720.00) + 7200.00" ] },
          "spawn_message": "A hideous mockery of the human form materializes!",
          "spawn_message_plural": "Hideous mockerys of the human form materialize!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_crawling_things') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 12 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The things you called up resist your attempt to control them!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_living_vortex",
    "type": "SPELL",
    "name": { "str": "Call Forth the Living Vortex" },
    "description": "Using this spell will summon a spirit of living wind that glows with ethereal light.  It is <color_yellow>somewhat difficult</color> to control",
    "message": "\"Tvakaros, ievona karoh…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_LIVING_VORTEX",
    "energy_source": "STAMINA",
    "difficulty": 60,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 560,
    "final_casting_time": 280,
    "casting_time_increment": -28,
    "base_energy_cost": 3500,
    "final_energy_cost": 1750,
    "energy_increment": -175,
    "min_duration": 720000,
    "max_duration": 1440000,
    "duration_increment": 72000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_LIVING_VORTEX",
    "//": "94% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Living Vortex",
        "range": { "math": [ "(u_spell_level('arcana_summoning_living_vortex') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_vortex_summoned",
          "summoner_is_alpha": true,
          "real_count": 1,
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_living_vortex') * 720.00) + 7200.00" ] },
          "spawn_message": "A swirl of wind and light coalesces out of the air!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_living_vortex') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 12 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resist your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_shapeshifting_thing",
    "type": "SPELL",
    "name": { "str": "Call Forth that Which Wears the Skins of Men" },
    "description": "Using this spell will summon a shapeshifting thing that hides in humanoid form until close to its prey.  It is <color_yellow>difficult</color> to control",
    "message": "\"That which hides among us, which hunts us even in our most guarded habitation, come forth…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_SHAPESHIFTING_THING",
    "energy_source": "STAMINA",
    "difficulty": 80,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 720,
    "final_casting_time": 360,
    "casting_time_increment": -36,
    "base_energy_cost": 3800,
    "final_energy_cost": 1900,
    "energy_increment": -190,
    "min_duration": 960000,
    "max_duration": 1920000,
    "duration_increment": 96000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_SHAPESHIFTING_THING",
    "//": "89% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon Shapeshifting Thing",
        "range": { "math": [ "(u_spell_level('arcana_summoning_shapeshifting_thing') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_thing_summoned",
          "summoner_is_alpha": true,
          "real_count": 1,
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_shapeshifting_thing') * 960.00) + 9600.00" ] },
          "spawn_message": "An amorphous abomination coalesces out of the air!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_shapeshifting_thing') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 14 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resist your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_nether_huntsman",
    "type": "SPELL",
    "name": { "str": "Call Forth the Hunter from Beyond" },
    "description": "Using this spell will summon an otherworldly hunter of men.  It is <color_yellow>difficult</color> to control.",
    "message": "\"Tvakaros, ievona karoh…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_NETHER_HUNTSMAN",
    "energy_source": "STAMINA",
    "difficulty": 90,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 760,
    "final_casting_time": 380,
    "casting_time_increment": -38,
    "base_energy_cost": 3950,
    "final_energy_cost": 1975,
    "energy_increment": -197.5,
    "min_duration": 1080000,
    "max_duration": 2160000,
    "duration_increment": 108000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_NETHER_HUNTSMAN",
    "//": "85% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon the Hunter from Beyond",
        "range": { "math": [ "(u_spell_level('arcana_summoning_nether_huntsman') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_thing_summoned",
          "summoner_is_alpha": true,
          "real_count": { "math": [ "(u_spell_level('arcana_summoning_nether_huntsman') * 0.2) + 1" ] },
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_nether_huntsman') * 1080.00) + 10800.00" ] },
          "spawn_message": "A hulking creature covered with numerous spines suddenly appears!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_nether_huntsman') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 15 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resist your attempt to control it!", "type": "bad" } ]
      }
    ]
  },
  {
    "id": "arcana_summoning_seraphic_shade",
    "type": "SPELL",
    "name": { "str": "Call Forth the Messenger of the Abyss" },
    "description": "Using this spell will summon a shadowy being with wings of darkness.  It is <color_yellow>extremely difficult</color> to control",
    "message": "\"Tvakaros, ievona karoh…\"  You cast %s!",
    "valid_targets": [ "self" ],
    "flags": [ "VERBAL", "SOMATIC", "NO_LEGS" ],
    "effect": "effect_on_condition",
    "shape": "blast",
    "effect_str": "EOC_ARCANA_SUMMON_SERAPHIC_SHADE",
    "energy_source": "STAMINA",
    "difficulty": 140,
    "skill": "magic",
    "max_level": 15,
    "base_casting_time": 1080,
    "final_casting_time": 540,
    "casting_time_increment": -54,
    "base_energy_cost": 6500,
    "final_energy_cost": 3250,
    "energy_increment": -320,
    "min_duration": 1080000,
    "max_duration": 2160000,
    "duration_increment": 108000,
    "spell_class": "ARCANA_SUMMONING",
    "magic_type": "arcana_summoning"
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_ARCANA_SUMMON_SERAPHIC_SHADE",
    "//": "50% chance to control at max level.",
    "effect": [
      {
        "u_query_tile": "line_of_sight",
        "target_var": { "context_val": "summoning_loc" },
        "message": "Summon the Messenger of the Abyss",
        "range": { "math": [ "(u_spell_level('arcana_summoning_seraphic_shade') * 0.5) + 3" ] }
      },
      {
        "if": { "math": [ "has_var(_summoning_loc)" ] },
        "then": {
          "u_spawn_monster": "mon_seraphic_shade_summoned",
          "summoner_is_alpha": true,
          "real_count": 1,
          "max_radius": 2,
          "target_var": { "context_val": "summoning_loc" },
          "lifespan": { "math": [ "(u_spell_level('arcana_summoning_seraphic_shade') * 1080.00) + 10800.00" ] },
          "spawn_message": "A shadow with enormous dark wings appears!"
        },
        "else": { "u_message": "Canceled." }
      },
      {
        "if": {
          "math": [
            "( rand(u_skill('magic') ) + rand(u_spell_level('arcana_summoning_seraphic_shade') ) + rand(8) + rand(8) + (u_effect_intensity('effect_arcana_summoning_bonus_chance') * 5) ) > 23 "
          ]
        },
        "then": [ { "u_cast_spell": { "id": "arcana_summoning_successful_control" }, "loc": { "context_val": "summoning_loc" } } ],
        "else": [ { "u_message": "The thing you called up resist your attempt to control it!", "type": "bad" } ]
      }
    ]
  }
]
